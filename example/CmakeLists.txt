#--------------------------------------------------------------------
# Basic Example Configures   
#--------------------------------------------------------------------

include(FetchContent)

# Setup OpenGL
cmake_policy(SET CMP0072 NEW) 

find_package(OpenGL REQUIRED)

# # Setup GLFW
# FetchContent_Declare(
#     glfw
#     GIT_REPOSITORY https://github.com/glfw/glfw.git
#     GIT_TAG "3.3.8"
#     GIT_SHALLOW  TRUE
#     GIT_PROGRESS TRUE
# )

# FetchContent_MakeAvailable(glfw)


# # Setup ImGui
# FetchContent_Declare(
#     imgui
#     GIT_REPOSITORY https://github.com/ocornut/imgui.git
#     GIT_TAG docking
#     GIT_SHALLOW  TRUE
#     GIT_PROGRESS TRUE
# )

# FetchContent_MakeAvailable(imgui)

# set(IMGUI_SOURCES
#     "${imgui_SOURCE_DIR}/imgui.cpp"
#     "${imgui_SOURCE_DIR}/imgui_demo.cpp"
#     "${imgui_SOURCE_DIR}/imgui_draw.cpp"
#     "${imgui_SOURCE_DIR}/imgui_tables.cpp"
#     "${imgui_SOURCE_DIR}/imgui_widgets.cpp"
#     "${imgui_SOURCE_DIR}/backend/imgui_widgets.cpp"
#     "${imgui_SOURCE_DIR}/backend/imgui_widgets.cpp"
# )

# # ImGui - Immediate Mode UI
# add_library(imgui STATIC ${IMGUI_SOURCES} )
# add_library(ImGui::ImGui ALIAS imgui)

# target_include_directories(imgui PUBLIC "${imgui_SOURCE_DIR}/" "${imgui_SOURCE_DIR}/backends/")
# target_link_libraries(imgui PUBLIC glfw OpenGL::GL)

set(IMGUI_SOURCES
    "${CMAKE_CURRENT_SOURCE_DIR}/imgui.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/imgui_demo.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/imgui_draw.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/imgui_tables.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/imgui_widgets.cpp"
)

# ImGui - Immediate Mode UI
add_library(imgui STATIC ${IMGUI_SOURCES} )
add_library(ImGui::ImGui ALIAS imgui)

target_include_directories(imgui PUBLIC "${CMAKE_CURRENT_SOURCE_DIR}/")
target_link_libraries(imgui PUBLIC OpenGL::GL)
set_target_properties(imgui PROPERTIES FOLDER "Examples")

#--------------------------------------------------------------------
# Example Functions
#--------------------------------------------------------------------

# add a new target which is an example
# example: imguizmo_add_example(main-examples
#                     SOURCES example.cpp
#                     DEPENDS ImGuizmo::ImGuizmo)
function(imguizmo_add_example target)

    # parse the arguments
    cmake_parse_arguments(THIS "" "" "SOURCES;DEPENDS" ${ARGN})
    if(NOT "${THIS_UNPARSED_ARGUMENTS}" STREQUAL "")
        message(FATAL_ERROR "Extra unparsed arguments when calling imguizmo_add_example: ${THIS_UNPARSED_ARGUMENTS}")
    endif()

    # set a source group for the source files
    source_group("" FILES ${THIS_SOURCES})

    # create the target
    add_executable(${target} ${THIS_SOURCES})

    # set the target's folder (for IDEs that support it, e.g. Visual Studio)
    set_target_properties(${target} PROPERTIES FOLDER "Examples")

    # set the Visual Studio startup path for debugging
    set_target_properties(${target} PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})

    # link the target to its dependencies
    target_link_libraries(${target} PRIVATE ${THIS_DEPENDS} OpenGL::GL ImGuizmo::ImGuizmo ImGui::ImGui)

    # Enable support for UTF-8 characters in source code
    if(MSVC)
        target_compile_options(${target} PRIVATE /utf-8)
    endif()
endfunction()

#--------------------------------------------------------------------
# Manually or Recursively add Examples
#--------------------------------------------------------------------

imguizmo_add_example(example
                    SOURCES main.cpp)
